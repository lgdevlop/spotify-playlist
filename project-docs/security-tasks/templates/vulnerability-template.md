# 🔴 SEC-XXX: [Vulnerability Title]

## 📋 Basic Information

| Field | Value |
|-------|-------|
| **Vulnerability ID** | SEC-XXX |
| **Severity** | [Critical/High/Medium/Low] |
| **CVSS Score** | [X.X] |
| **Component** | [Component Name] |
| **Location** | `[file:line]` |
| **Discovery Date** | [MM/DD/YYYY] |
| **Status** | [Open/In Progress/Resolved] |

## 🎯 Description

[Detailed description of the vulnerability, including technical context and impact]

### Potential Impact

- [Impact 1]
- [Impact 2]
- [Impact 3]

### Exploitation Examples

```javascript
// Example code that exploits the vulnerability
[exploitation code]
```

### Evidence Found

```typescript
// Vulnerable code snippet
[vulnerable code]
```

## 🔧 Remediation Plan

### Specific Actions Required

1. [Action 1]
2. [Action 2]
3. [Action 3]

### Detailed Remediation Steps

#### Step 1: [Step Title]

[Detailed step description]

```typescript
// Implementation example
[fix code]
```

#### Step 2: [Step Title]

[Detailed step description]

```typescript
// Implementation example
[fix code]
```

### Dependencies Between Fixes

- **Depends on:** [List of other fixes]
- **Unblocks:** [List of other fixes]

### Implementation Risks

- **High:** [Risk description]
- **Medium:** [Risk description]
- **Low:** [Risk description]

## 🌿 Branch Strategy (According to Project Guidelines)

### Recommended Branch

```bash
git checkout -b fix/security-sec[XXX]-[kebab-case-description]
```

### Example

```bash
git checkout -b fix/security-sec001-client-secret-exposure
```

### Pull Request Template

**Title:**

```text
🐛 fix(security): implement fix for SEC-[XXX] - [brief description]
```

**Body:**

```markdown
### ✍️ What was done

This PR implements the security fix for vulnerability SEC-[XXX] ([severity severity]) in the [component name] component.

* Removed exposure of [sensitive data] from [endpoint/function]
* Added proper input validation for [specific inputs]
* Implemented secure logging practices to prevent [data leakage]
* Added security headers to prevent [attack vector]
* Updated session management to use [secure method]

### 📌 Why it matters

Without this change, the application is vulnerable to [attack type] which could lead to [consequence]. Attackers could [specific attack scenario], compromising [assets/data].

This fix ensures that [security improvement] and helps prevent [attack type] by implementing [specific security measures].

### 🧪 How to test

1. Start the application and navigate to [affected component]
2. Attempt to reproduce the vulnerability using [test method]
3. Verify that the fix prevents the attack and returns appropriate error
4. Check that logs no longer contain sensitive information
5. Validate that normal functionality remains intact
6. Run security tests: `bun run test:security`

### 📎 Related

Closes #[issue_number]
Depends on #[dependency_issue_number]
```

## 🚀 GitHub CLI Commands

### Create Issue

```bash
gh issue create \
  --title "🔴 SEC-[XXX]: [Vulnerability Title]" \
  --body-file project-docs/security-tasks/[category]/SEC-[XXX]-[file].md \
  --label "security,[severity],SEC-[XXX]"
```

### Create Branch and PR

```bash
# Create branch
git checkout -b fix/security-sec[XXX]-[kebab-case-description]

# Push and create PR
git push origin fix/security-sec[XXX]-[kebab-case-description]
gh pr create \
  --title "🐛 fix(security): implement fix for SEC-[XXX] - [description]" \
  --body "This PR implements the security fix for vulnerability SEC-[XXX]. Refer to the PR template for detailed testing instructions." \
  --label "security,fix"
```

### Update Status

```bash
# Add progress comment
gh issue comment <issue_number> --body "🔄 Status: Implementation in progress"

# Close issue after merge
gh issue close <issue_number> --comment "✅ Resolved via PR #<pr_number>"
```

## 📊 Success Criteria

### Functional Validation

- [ ] Main functionality preserved
- [ ] No regressions introduced
- [ ] Performance maintained

### Security Validation

- [ ] Vulnerability completely mitigated
- [ ] No new vulnerabilities introduced
- [ ] Security tests passing

### Code Validation

- [ ] Code review approved
- [ ] Automated tests passing
- [ ] Documentation updated

## 🧪 Test Plan

### Automated Tests

```typescript
// tests/security/SEC-[XXX].test.ts
describe('SEC-[XXX]: [Vulnerability Title]', () => {
  test('should not expose sensitive data', async () => {
    // Implement test
  });
  
  test('should validate inputs properly', async () => {
    // Implement test
  });
});
```

### Manual Tests

- [ ] Manual exploitation test
- [ ] Staging environment validation
- [ ] Regression test

### Validation Tools

```bash
# OWASP ZAP
zap-baseline.py -t http://localhost:3000

# Nmap
nmap -sV -sC localhost

# Curl for API tests
curl -X GET http://localhost:3000/api/config
```

## 📈 Metrics and Monitoring

### Before/After Metrics

| Metric | Before | After | Improvement |
|--------|--------|-------|-------------|
| [Metric 1] | [Value] | [Value] | [Δ%] |
| [Metric 2] | [Value] | [Value] | [Δ%] |

### Post-Deploy Monitoring

- [ ] Alerts configured
- [ ] Dashboard updated
- [ ] Logs monitored

## 📚 References

- [Branching Guidelines](../../branching-guidelines.md)
- [Merge Commit Guidelines](../../merge-commit-guidelines.md)
- [Security Vulnerabilities Report](../../../security-vulnerabilities-report.md)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CVE Database](https://cve.mitre.org/)

## 🔄 Change History

| Date | Version | Author | Change |
|-------|--------|-------|--------|
| [MM/DD/YYYY] | 1.0 | [Author] | Initial creation |
| [MM/DD/YYYY] | 1.1 | [Author] | [Change description] |

## 📝 Additional Notes

[Any additional relevant information for the fix]

---

**Status:** [Open/In Progress/Resolved]  
**Assigned to:** [Responsible name]  
**Due date:** [MM/DD/YYYY]  
**Priority:** [1/2/3/4]  
**Complexity:** [Low/Medium/High]

## 🚀 Quick Commands

```bash
# Create issue
gh issue create --title "🔴 SEC-[XXX]: [Title]" --body-file $(pwd)/project-docs/security-tasks/[category]/SEC-[XXX]-[file].md --label "security,[severity],SEC-[XXX]"

# Create branch
git checkout -b fix/security-sec[XXX]-[description]

# Create PR
gh pr create --title "🐛 fix(security): SEC-[XXX] - [description]" --body "This PR implements the security fix for vulnerability SEC-[XXX]. Refer to the PR template for detailed testing instructions." --label "security,fix"

# Tests
bun run test:security
bun run test:unit
bun run build
